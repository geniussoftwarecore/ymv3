# ๐ ุฏููู ูุธุงู ุชุณุฌูู ุงูุฏุฎูู ุงููุชูุฏู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ุชุณุฌูู ุฏุฎูู ุงุญุชุฑุงูู ูุดูู ุงูููุฒุงุช ุงูุชุงููุฉ:

โ **ุชุณุฌูู ุฏุฎูู ุจุงุณู ุงููุณุชุฎุฏู + ูููุฉ ุงููุฑูุฑ**  
โ **ุชุณุฌูู ุฏุฎูู ุฃูููุงูู ูู ุจูุงูุงุช ูุญููุธุฉ ูุญููุงู**  
โ **ูุตุงุฏูุฉ ุจูููุชุฑูุฉ (ุจุตูุฉ ุงูุฅุตุจุน / ุงูุชุนุฑู ุนูู ุงููุฌู)**  
โ **ุงูุชุดุงู ุญุงูุฉ ุงูุงุชุตุงู ุงูุฅูุชุฑูุช**  
โ **ุญูุธ ุขูู ููุฌูุณุงุช ุงููุญููุฉ**  

---

## ๐ง ุงูุชููููุงุช ุงููุทููุจุฉ

### 1๏ธโฃ **ุงูุชุซุจูุช ูุงูููุชุจุงุช**

ุชุฃูุฏ ูู ุชุดุบูู ุงูุฃูุงูุฑ ุงูุชุงููุฉ:

```bash
# ุชุซุจูุช ุงูููุชุจุงุช
flutter pub get

# ูู iOS ููุท - ุชุซุจูุช Pod
cd ios
pod install
cd ..

# ูู Android - ุชุญุฏูุซ build.gradle ุฅุฐุง ูุฒู ุงูุฃูุฑ
```

**ุงูููุชุจุงุช ุงููุถุงูุฉ:**
- `local_auth: ^2.1.6` - ูููุตุงุฏูุฉ ุงูุจูููุชุฑูุฉ
- `local_auth_ios: ^1.0.7` - ุฏุนู iOS ููุจุตูุฉ
- `connectivity_plus: ^6.0.0` - ุงูุชุดุงู ุงูุงุชุตุงู

### 2๏ธโฃ **ุชูููู Android**

ูู `android/app/build.gradle`:

```gradle
android {
    compileSdkVersion 34  // ุฃู ุฃุญุฏุซ
    
    defaultConfig {
        minSdkVersion 21  // ุงูุญุฏ ุงูุฃุฏูู
        targetSdkVersion 34  // ุฃู ุฃุญุฏุซ
    }
}
```

ูู `android/app/src/main/AndroidManifest.xml`:

```xml
<manifest ...>
    <!-- ุงูุจุตูุฉ -->
    <uses-permission android:name="android.permission.USE_BIOMETRIC" />
    <uses-permission android:name="android.permission.USE_FINGERPRINT" />
    
    <!-- ุงูุฅูุชุฑูุช -->
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    <uses-permission android:name="android.permission.CHANGE_NETWORK_STATE" />
    
    <application ...>
    </application>
</manifest>
```

ูู `android/app/build.gradle` (dependencies):

```gradle
dependencies {
    implementation 'androidx.biometric:biometric:1.1.0'
    implementation 'com.google.android.gms:play-services-tasks:18.1.0'
}
```

### 3๏ธโฃ **ุชูููู iOS**

ูู `ios/Runner/Info.plist`:

```xml
<dict>
    <!-- ุงูุจุตูุฉ ู Face ID -->
    <key>NSFaceIDUsageDescription</key>
    <string>ูุญุชุงุฌ ุฅูู ูุฌูู ููุชุญูู ูู ูููุชู</string>
    
    <key>NSBiometricUsageDescription</key>
    <string>ูุญุชุงุฌ ุฅูู ุจุตูุชู ููุชุญูู ูู ูููุชู</string>
    
    <!-- ุงูุฅูุชุฑูุช -->
    <key>NSLocalNetworkUsageDescription</key>
    <string>ูุญุชุงุฌ ุฅูู ุงูุชุญูู ูู ุญุงูุฉ ุงูุงุชุตุงู</string>
    
    ...
</dict>
```

### 4๏ธโฃ **ุชูููู Windows**

ูู `windows/runner/windows_manifest.xml`:

```xml
<assembly ...>
    <dependency>
        <dependentAssembly>
            <!-- ูุฏ ุชุญุชุงุฌ ุฅูู ุฅุถุงูุฉ ุชุจุนูุงุช Windows ุฅุฐุง ูุฒู ุงูุฃูุฑ -->
        </dependentAssembly>
    </dependency>
</assembly>
```

---

## ๐ ูููู ุงููููุงุช ุงูุฌุฏูุฏ

```
lib/
โโโ core/
โ   โโโ services/
โ       โโโ biometric_service.dart         โจ ุฎุฏูุฉ ุงูุจุตูุฉ
โ       โโโ local_auth_storage.dart        โจ ุฎุฏูุฉ ุงูุชุฎุฒูู ุงููุญูู
โ
โโโ features/
    โโโ auth/
        โโโ presentation/
            โโโ pages/
                โโโ login_page.dart        โ๏ธ ุชู ุชุญุฏูุซูุง
```

---

## ๐ฏ ุงูุงุณุชุฎุฏุงู

### **1. ุชุณุฌูู ุงูุฏุฎูู ุงูุนุงุฏู**

```dart
// ูุชู ูุนุงูุฌุชู ูู _handleLogin()
// ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุฏุฎูู"

// ูุญูุธ ุงูุฌูุณุฉ ูุญููุงู ุฅุฐุง ุงุฎุชุงุฑ ุงููุณุชุฎุฏู "ุชุฐูุฑูู"
```

**ุงูุณููู ุงููุชููุน:**
- ุงููุณุชุฎุฏู ูุฏุฎู ุงุณู ุงููุณุชุฎุฏู + ูููุฉ ุงููุฑูุฑ
- ูุถุบุท "ุฏุฎูู"
- ุฅุฐุง ูุงู "ุชุฐูุฑูู" ููุนูุงู โ ูุชู ุญูุธ ุงูุฌูุณุฉ ูุญููุงู
- ุงูุงูุชูุงู ุฅูู ููุญุฉ ุงูุชุญูู

---

### **2. ุชุณุฌูู ุงูุฏุฎูู ุจุงูุจุตูุฉ**

```dart
// ูุชู ูุนุงูุฌุชู ูู _handleBiometricLogin()
// ุนูุฏ ุงูุถุบุท ุนูู ุฒุฑ "ุชุณุฌูู ุฏุฎูู ุจุงูุจุตูุฉ"

// ุดุฑูุท ุงูุธููุฑ:
// - ูุฌุจ ุฃู ุชููู ุงูุจุตูุงุช ูุชุงุญุฉ ุนูู ุงูุฌูุงุฒ
// - ูุฌุจ ุฃู ุชูุฌุฏ ุฌูุณุฉ ูุญููุธุฉ ุณุงุจูุฉ
```

**ุงููููุฒุงุช:**
- โ ุงูุชุญูู ุงูููุฑู ูู ุชููุฑ ุงูุจุตูุงุช
- โ ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ
- โ ูุนุงูุฌุฉ ุงูุญุงูุงุช ุงููุฎุชููุฉ (ูููููุ ูู ูุชู ุงูุชุณุฌููุ ุฅูุฎ)

**ุงูุฃุฎุทุงุก ุงููุญุชููุฉ:**
- `BiometricNotAvailableException` - ูุง ุชูุฌุฏ ุจุตูุงุช
- `BiometricNotEnrolledException` - ูู ูุชู ุชุณุฌูู ุจุตูุงุช
- `BiometricLockedException` - ููููุฉ ูุคูุชุงู
- `BiometricUserCanceledException` - ุฃูุบู ุงููุณุชุฎุฏู

---

### **3. ุชุณุฌูู ุงูุฏุฎูู ุงูุฃูููุงูู**

```dart
// ูุชู ูุนุงูุฌุชู ูู _handleOfflineLogin()
// ุนูุฏ ุงูุถุบุท ุนูู "ุชุณุฌูู ุฏุฎูู ุฃูููุงูู"

// ุดุฑูุท ุงูุธููุฑ:
// - ูุง ููุฌุฏ ุฅูุชุฑูุช
// - ุชูุฌุฏ ุฌูุณุฉ ูุญููุธุฉ ุณุงุจูุฉ
```

**ุงูุณููุงุฑูู:**
1. ุงููุณุชุฎุฏู ูุฏุฎู ุจูุฌุงุญ ูุน ุงูุฅูุชุฑูุช
2. ูุฎุชุงุฑ "ุชุฐูุฑูู"
3. ูู ุงููุฑุงุช ุงููุงุฏูุฉ ุจุฏูู ุฅูุชุฑูุช:
   - ูุธูุฑ ุฒุฑ "ุชุณุฌูู ุฏุฎูู ุฃูููุงูู ูู [username]"
   - ูุถุบุท ุงูุฒุฑ
   - ูุฏุฎู ุจุฏูู ุฅูุชุฑูุช

---

## ๐ ุงูุจูุงูุงุช ุงููุญููุธุฉ ูุญููุงู

### **ุงููููุฐุฌ: `LocalSessionData`**

```dart
LocalSessionData {
  username: String,          // ุงุณู ุงููุณุชุฎุฏู
  password: String,          // ูููุฉ ุงููุฑูุฑ (ุชูุจูู ุฃููู)
  email: String,             // ุงูุจุฑูุฏ
  userId: String,            // ูุนุฑู ุงููุณุชุฎุฏู
  authToken: String,         // ุฑูุฒ ุงููุตุงุฏูุฉ
  lastLoginTime: DateTime,   // ุขุฎุฑ ููุช ุฏุฎูู
  useBiometric: bool,        // ูู ูุณุชุฎุฏู ุงูุจุตูุฉ
}
```

### **ุงูุฏูุงู ุงููุชุงุญุฉ: `LocalAuthStorage`**

| ุงูุฏุงูุฉ | ุงููุตู |
|--------|-------|
| `initialize()` | ุชููุฆุฉ ุงูุชุฎุฒูู |
| `saveSessionData()` | ุญูุธ ุฌูุณุฉ ุฌุฏูุฏุฉ |
| `getSessionData()` | ุงุณุชุฑุฌุงุน ุงูุฌูุณุฉ ุงููุญููุธุฉ |
| `hasLocalSession()` | ุงูุชุญูู ูู ูุฌูุฏ ุฌูุณุฉ |
| `isOfflineLoginEnabled()` | ุงูุชุญูู ูู ุชูุนูู ุงูุฃูููุงูู |
| `getCachedUsername()` | ุงูุญุตูู ุนูู ุขุฎุฑ ุงุณู ูุณุชุฎุฏู |
| `clearSessionData()` | ุญุฐู ุงูุฌูุณุฉ (ุชุณุฌูู ุฎุฑูุฌ) |
| `isSessionValid()` | ุงูุชุญูู ูู ุตูุงุญูุฉ ุงูุฌูุณุฉ (30 ููู) |
| `updateLastLoginTime()` | ุชุญุฏูุซ ููุช ุงูุฏุฎูู |
| `setUseBiometric()` | ุชูุนูู/ุชุนุทูู ุงูุจุตูุฉ |

---

## ๐ก๏ธ ุชุญุฐูุฑุงุช ุฃูููุฉ

### โ๏ธ ุญูุธ ูููุงุช ุงููุฑูุฑ

**ูุง ุชุญูุธ ูููุงุช ุงููุฑูุฑ ุจูุต ุนุงุฏู!**

ุงูุญู ุงูุฃูุถู:

```dart
// ุจุฏูุงู ูู:
password: password  // โ ุฎุทุฑ!

// ุงุณุชุฎุฏู:
// 1. ุงูุชุดููุฑ (ูุซู flutter_secure_storage)
// 2. ุญูุธ ุงูุชููู ููุท ุจุฏูุงู ูู ุงููููุฉ ุงููุฑูุฑูุฉ
// 3. ุงุณุชุฎุฏุงู ุงูุจุตูุฉ ุจุฏูุงู ูู ุญูุธ ุงูุจูุงูุงุช
```

### โ ุงูููุงุฑุณุงุช ุงูุฃููุฉ ุงูููุตู ุจูุง

```dart
// 1. ุงุณุชุฎุฏู flutter_secure_storage ูุญูุธ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ
import 'package:flutter_secure_storage/flutter_secure_storage.dart';

// 2. ุญูุธ ุงูุชููู ุจุฏูุงู ูู ุงููููุฉ ุงููุฑูุฑูุฉ
LocalSessionData(
  username: username,
  password: '',  // ูุง ุชุญูุธ!
  authToken: tokenFromServer,  // โ ุญูุธ ุงูุชููู
  ...
)

// 3. ุตูุงุญูุฉ ุงูุฌูุณุฉ ูุญุฏูุฏุฉ
await _localAuthStorage.isSessionValid(maxAge: const Duration(days: 7));
```

---

## ๐งช ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### **ุงูุณููุงุฑูู 1: ุฏุฎูู ุนุงุฏู ูุงุฌุญ**
```
โ ุงููุณุชุฎุฏู ูุฏุฎู username + password
โ ูุฎุชุงุฑ "ุชุฐูุฑูู"
โ ูุถุบุท "ุฏุฎูู"
โ ุงูุฌูุณุฉ ุชูุญูุธ ูุญููุงู
โ ุงูุงูุชูุงู ูููุญุฉ ุงูุชุญูู
```

### **ุงูุณููุงุฑูู 2: ุฏุฎูู ุจุงูุจุตูุฉ**
```
โ ุฌูุณุฉ ูุญููุธุฉ + ุจุตูุงุช ูุชุงุญุฉ
โ ูุถุบุท "ุชุณุฌูู ุฏุฎูู ุจุงูุจุตูุฉ"
โ ูููุฑ ุนูู ุญุณุงุณ ุงูุจุตูุฉ
โ ุชุณุฌูู ุฏุฎูู ูุงุฌุญ
โ ุงูุงูุชูุงู ูููุญุฉ ุงูุชุญูู
```

### **ุงูุณููุงุฑูู 3: ุฏุฎูู ุฃูููุงูู**
```
โ ูุง ุฅูุชุฑูุช + ุฌูุณุฉ ูุญููุธุฉ
โ ูุธูุฑ "ุชุณุฌูู ุฏุฎูู ุฃูููุงูู ูู [username]"
โ ูุถุบุท ุงูุฒุฑ
โ ุฏุฎูู ูุงุฌุญ ุจุฏูู ุฅูุชุฑูุช
โ ุงูุงูุชูุงู ูููุญุฉ ุงูุชุญูู (ูุถุน ุฃูููุงูู)
```

### **ุงูุณููุงุฑูู 4: ุฑุณุงูุฉ ุงูุฎุทุฃ - ุจุฏูู ุจุตูุงุช**
```
โ ุจุตูุงุช ุบูุฑ ูุชููุฑุฉ ุนูู ุงูุฌูุงุฒ
โ ูุง ูุธูุฑ ุฒุฑ ุงูุจุตูุฉ
โ ุฒุฑ "ุชุณุฌูู ุฏุฎูู ุจุงูุจุตูุฉ" ูุฎุชูู
โ ูููู ุงุณุชุฎุฏุงู ุงูุทุฑู ุงูุฃุฎุฑู
```

### **ุงูุณููุงุฑูู 5: ููู ุงูุจุตูุฉ**
```
โ ุนุฏุฉ ูุญุงููุงุช ูุงุดูุฉ ููุจุตูุฉ
โ ุงููุธุงู ูููู ุงูุจุตูุฉ ูุคูุชุงู
โ ุฑุณุงูุฉ: "ุชู ููู ุงูุจุตูุฉ ูุคูุชุงู. ูุฑุฌู ุงููุญุงููุฉ ูุงุญูุงู"
โ ูููู ุงูุชุจุฏูู ููุฏุฎูู ุงูุนุงุฏู
```

---

## ๐ ุชุญุฏูุซ ุงูููุฏ ูู ุงููุณุชูุจู

### **ูุฅุถุงูุฉ ุจุตูุฉ ุงูุนูู (Iris)**

```dart
// ูู BiometricService.dart
// ุจุตูุฉ ุงูุนูู ูุฏุนููุฉ ุจุงููุนู ูู local_auth
// ููู ููุณุช ูุชุงุญุฉ ูู ุฌููุน ุงูุฃุฌูุฒุฉ

Future<String> getBiometricTypeName() async {
  final biometrics = await getAvailableBiometrics();
  
  for (final type in biometrics) {
    if (type == BiometricType.iris) {
      return 'ุจุตูุฉ ุงูุนูู';  // โ ุณูุชู ุฏุนููุง
    }
  }
  return 'ุบูุฑ ูุชููุฑ';
}
```

### **ูุฅุถุงูุฉ ูุตุงุฏูุฉ ูุชุนุฏุฏุฉ ุงูุนูุงูู (MFA)**

```dart
// Future enhancement
Future<void> _handleMFALogin() async {
  // 1. ุฏุฎูู ุนุงุฏู
  // 2. ุฅุฑุณุงู OTP ุฃู ุฑูุฒ ุงูุชุญูู
  // 3. ุงูุชุญูู ูู ุงูุฑูุฒ
  // 4. ุชุณุฌูู ุงูุฏุฎูู ุงููุงุฌุญ
}
```

---

## ๐ฑ ุงูููุตุงุช ุงููุฏุนููุฉ

| ุงูููุตุฉ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|--------|--------|---------|
| **Android** | โ ูุฏุนููุฉ | API 21+ |
| **iOS** | โ ูุฏุนููุฉ | 11.0+ |
| **Web** | โ๏ธ ูุญุฏูุฏ | ุจุฏูู ุจุตูุฉ |
| **Windows** | โ๏ธ ูุญุฏูุฏ | ุจุฏูู ุจุตูุฉ |
| **macOS** | โ ูุฏุนููุฉ | Touch ID / Face ID |
| **Linux** | โ๏ธ ูุญุฏูุฏ | ุจุฏูู ุจุตูุฉ |

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ุงููุดููุฉ: ุฒุฑ ุงูุจุตูุฉ ูุง ูุธูุฑ**
```dart
// ุชุญูู ูู:
1. _isBiometricAvailable = false  // ูู ุชู ุชุนุทูููุ
2. ูุง ุชูุฌุฏ ุฌูุณุฉ ูุญููุธุฉ        // ูุญุชุงุฌ ุฌูุณุฉ ุณุงุจูุฉ
3. ุงูููุตุฉ ูุง ุชุฏุนู ุงูุจุตูุฉ       // ููุจ ูุซูุงู
```

### **ุงููุดููุฉ: ุงูุจุตูุฉ ูุง ุชุนูู**
```dart
// ุชุญูู ูู:
1. ุงูุชุตุงุฑูุญ ูู AndroidManifest.xml
2. ุชุณุฌูู ุงูุจุตูุงุช ุนูู ุงูุฌูุงุฒ
3. ูุง ุชูุฌุฏ ุฌูุณุฉ ูุญููุธุฉ
4. ุงูุจุตูุฉ ููููุฉ ูุคูุชุงู
```

### **ุงููุดููุฉ: ุงูุฃูููุงูู ูุง ูุนูู**
```dart
// ุชุญูู ูู:
1. ุงูุงุชุตุงู ูุนุทู ูุนูุงู
2. ุชูุฌุฏ ุฌูุณุฉ ูุญููุธุฉ
3. isOfflineLoginEnabled = true
```

---

## ๐ ุงูุฏุนู ูุงููุณุงุนุฏุฉ

ูููุฒูุฏ ูู ุงููุนูููุงุช:
- ๐ [local_auth documentation](https://pub.dev/packages/local_auth)
- ๐ [connectivity_plus documentation](https://pub.dev/packages/connectivity_plus)
- ๐ [Flutter Security Best Practices](https://flutter.dev/docs/security/security)

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2024
**ุงูุฅุตุฏุงุฑ:** 1.0.0